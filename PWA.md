# Progressive Web App (PWA) Features

This document explains the PWA implementation and how it enhances the user experience.

## What is a PWA?

A Progressive Web App is a type of application software delivered through the web, built using common web technologies including HTML, CSS, and JavaScript. PWAs are intended to work on any platform with a standards-compliant browser.

## Features Implemented

### 1. Web App Manifest (`/public/manifest.json`)

The manifest provides metadata about the application:

- **App Name**: "What To Cook: AI-Powered Recipe Ideas"
- **Short Name**: "What To Cook"
- **Display Mode**: Standalone (app-like experience without browser UI)
- **Theme Color**: #D2691E (terracotta)
- **Background Color**: #FFF8F0 (cream)
- **Icons**: 192x192 and 512x512 PNG icons with the cooking emoji (üç≥)
- **Orientation**: Portrait (optimal for mobile)
- **Shortcuts**: Quick action to generate recipes

### 2. Service Worker

The service worker is automatically generated by `next-pwa` during the production build:

- **Caching Strategy**: Network-first for API calls, cache-first for static assets
- **Offline Support**: Cached resources available offline
- **Auto-update**: Service worker updates automatically when new versions are deployed
- **Workbox**: Uses Workbox for advanced caching strategies

### 3. PWA Metadata

The app includes comprehensive PWA metadata in the HTML `<head>`:

- Manifest link
- Theme color for browser chrome
- Apple Web App tags for iOS devices
- Appropriate viewport settings for mobile devices
- Icons for various platforms and sizes

### 4. Installation

Users can install the app on their devices:

#### Mobile Installation
- **iOS**: Add to Home Screen via Safari share menu
- **Android**: "Add to Home Screen" or "Install App" prompt in Chrome

#### Desktop Installation
- Install icon appears in browser address bar (Chrome/Edge)
- App runs in standalone window
- Appears in application menu/launcher

## Technical Implementation

### Configuration

**`next.config.ts`:**
```typescript
import withPWA from "next-pwa";

export default withPWA({
  dest: "public",
  register: true,
  skipWaiting: true,
  disable: process.env.NODE_ENV === "development",
})(nextConfig);
```

### Service Worker Registration

**`src/components/PWARegister.tsx`:**
- Client-side component that registers the service worker
- Only runs in production mode
- Automatically handles registration lifecycle

### Build Process

1. During `npm run build`, next-pwa generates:
   - `/public/sw.js` - Service worker
   - `/public/workbox-*.js` - Workbox runtime

2. These files are excluded from git via `.gitignore`
3. They are regenerated on each build

## Benefits

### For Users

1. **Fast Loading**: Cached assets load instantly
2. **Offline Access**: View cached content without internet
3. **App-like Experience**: Runs in standalone window without browser UI
4. **Home Screen Icon**: Quick access like a native app
5. **Reduced Data Usage**: Assets cached after first visit

### For Developers

1. **Automatic Caching**: next-pwa handles caching strategies
2. **Easy Updates**: Service worker auto-updates on new deployments
3. **SEO Friendly**: Still a web app, fully crawlable
4. **Cross-platform**: Single codebase for all platforms

## Testing

### Local Testing

1. Build for production:
   ```bash
   npm run build
   npm run start
   ```

2. Open DevTools > Application > Service Workers
3. Verify service worker is registered and active
4. Check "Offline" mode to test offline functionality

### Production Testing

1. Deploy to production
2. Open app in supported browser
3. Look for install prompt or install icon
4. Install and test standalone mode

## Browser Support

- **Chrome/Edge**: Full PWA support
- **Safari (iOS 11.3+)**: Supports Add to Home Screen
- **Firefox**: Limited PWA support
- **Samsung Internet**: Full PWA support

## Maintenance

### Updating Icons

To update app icons:

1. Create new icons (192x192 and 512x512)
2. Replace files in `/public/`
3. Update manifest.json if needed
4. Rebuild application

### Modifying Manifest

Edit `/public/manifest.json` to change:
- App name or description
- Theme/background colors
- Display mode
- Shortcuts
- Categories

### Service Worker Configuration

Modify `next.config.ts` to adjust:
- Cache destination
- Registration behavior
- Development mode behavior
- Custom service worker options

## Troubleshooting

### Service Worker Not Registering

1. Check console for errors
2. Verify production build (SW disabled in dev mode)
3. Ensure HTTPS or localhost
4. Clear browser cache and reload

### Install Prompt Not Showing

1. Verify manifest.json is accessible
2. Check all required manifest fields are present
3. Ensure icons are correct sizes
4. Service worker must be registered
5. Site must be visited at least twice with 5 minutes between visits

### Offline Mode Not Working

1. Visit site while online first
2. Check service worker is active in DevTools
3. Verify caching strategy in sw.js
4. Check cache storage in DevTools > Application > Cache Storage

## Resources

- [Next PWA Documentation](https://github.com/shadowwalker/next-pwa)
- [Web.dev PWA Guide](https://web.dev/progressive-web-apps/)
- [MDN Web App Manifest](https://developer.mozilla.org/en-US/docs/Web/Manifest)
- [Workbox Documentation](https://developers.google.com/web/tools/workbox)
